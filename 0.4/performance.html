<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>Performance</title><link rel="stylesheet" href="assets/css/style.css"><link rel="stylesheet" href="assets/css/zenburn.css"><script>//- If the query includes 'print-pdf' we'll use the PDF print sheet
document.write( '<link rel="stylesheet" href="assets/css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );</script><script src="assets/js/jquery-1.8.1.min.js"></script></head><body><div class="reveal"><div class="state-background"></div><div class="slides"><section><h1>Performance</h1></section><section><h2>Performance</h2><ul class="read-block"><li><b>.1 to 1 sec:</b> no feedback necessary</li><li><b>1 to 10 sec:</b> add some feedback (spinners)</li><li><b>> 10 sec:</b> the user is no longer here</li></ul><a href="http://www.useit.com/papers/responsetime.html" class="source">Source: Jakob Nielsen</a></section><section><h2>Impact on revenue</h2><ul class="read-block"><li>Google: +400 ms <b>-0.6% drop in searches/user</b></li><li>Yahoo: +400 ms    <b>-5-9% full-page traffic</b></li><li>Amazon: +100 ms <b>-1% sales</b></li><li>Firefox: +2 seg   <b>-15% downloads</b></li></ul><a href="http://www.stevesouders.com/blog/2010/05/07/wpo-web-performance-optimization/" class="source">Source: Steve Souders</a></section><section><h2>Impact on PageRank</h2><p>Starting 2010, <b>Google has added page performance</b> to the PageRank algorithm</p><a href="http://googlewebmastercentral.blogspot.com/2010/04/using-site-speed-in-web-search-ranking.html" class="source">Source: Google</a></section><section><h2>Best thing for performance</h2><p>Aim for simplicity</p><img src="assets/raster/simplicity-1.png"></section><section><img src="assets/raster/typical-product.png"></section><section><h2>Improve performance</h2><p>by following <b>14 rules</b> by Steve Souders</p></section><section><h2>Pre-process JavaScript and CSS</h2><ul><li>Rule 1 - Make <b>Fewer HTTP Requests</b></li><li>Rule 4 - <b>Gzip Components</b></li><li>Rule 10 - <b>Minify JavaScript</b></li><li>Rule 2 - Use a <b>Content Delivery Network</b></li></ul></section><section><h2>Content-delivery network</h2><p class="read-block">Use a third-party CDN</p><pre><code>https://ajax.googleapis.com/ajax/libs/jquery/1.5.2/jquery.min.js</code></pre><p class="read-block">Create your own CDN</p></section><section><h2>Active open connections</h2><p><b>6 connections</b> (used to be 2)</p><p>These are <b>shared for all active tabs</b></p><a href="http://www.browserscope.org/?category=network" class="source">Source: BrowserScope</a></section><section><h2>Location</h2><ul><li>Rule 5 - Put <b>stylesheets at the &lt;head></b></li><li>Rule 6 - Put <b>scripts at the bottom</b> (&lt;body>)</li><li>Rule 8 - Make <b>JavaScript and CSS external</b></li></ul></section><section><h2>Measure, don't guess</h2><p>What's faster, Facebook or LinkedIn?</p></section><section><h2>It used to be like this</h2><img src="assets/raster/facebook-vs-linkedin.png"></section><section data-state="lab"><h2>Lab: performance 1</h2><p>Compare performance of multiple websites using online tools</p></section><section><h2>Performance tools</h2><ul><li>Google PageSpeed</li><li>Webpagetest.org</li><li>Chrome resources tab</li></ul></section><section><h2>Some stats</h2><ul><li>Extracted from http://httparchive.org/</li><li>+17000 URLs analyzed:<ul><li>Alexa 500, US 500, 10,000</li><li>Fortune 500</li><li>Global 500</li><li>Quantcast10K</li></ul></li></ul></section><section><h2>Load times</h2><img src="assets/raster/load-times.png"></section><section><section><h2>Resource size</h2><img src="assets/raster/resource-size-1.png"><img src="assets/raster/resource-size-2.png"></section><section><h2>Resource size</h2><img src="assets/raster/resource-size-1.png"><ul><li>Lossy JPG compression</li><li>Lossless image compressors</li></ul></section><section id="high-compression"><h2>High compression in JPG</h2><p>Avoid 4x file sizes by using high lossy compression</p><div class="row-fluid"><div class="span6"><figure><img src="assets/raster/hdpi-small.jpg" width="50%"><figcaption class="small-text">250px×250px &mdash; 80% compression level</figcaption></figure></div><div class="span6"><figure><img src="assets/raster/hdpi-large.jpg" width="50%"><figcaption class="small-text">500px×500px &mdash; 30% compression level</figcaption></figure></div></div><span class="source">Source: <a href="http://blog.netvlies.nl/design-interactie/retina-revolution/">Netvlies</a> (<a href="http://translate.google.com/translate?sl=nl&tl=en&js=n&prev=_t&hl=en&ie=UTF-8&layout=2&eotf=1&u=http://blog.netvlies.nl/design-interactie/retina-revolutie-follow-up/&act=url">follow-up</a>) and <a href="http://commons.wikimedia.org/wiki/File:Epipedobates-tricolor-dreistreifen-baumsteiger.jpg">Wikimedia Commons</a></span></section></section><section><h2>External resources</h2><img src="assets/raster/external-resources-1.png"><img src="assets/raster/external-resources-2.png"></section><section><h2>PageSpeed score</h2><img src="assets/raster/pagespeed-score.png"></section><section><h2>mod_pagespeed</h2><p class="read-block">mod_pagespeed speeds up your site and reduces page load time. </p><p class="read-block fragment">Automatically applies web performance best practices to pages, and associated assets (CSS, JavaScript, images) without requiring that you modify your existing content or workflow.</p><p class="read-block fragment"><a href="https://developers.google.com/speed/pagespeed/mod" target="_blank">More info</a></p></section><section data-state="lab"><h2>Lab: performance 2</h2><p>Track performance with PageSpeed</p></section><section><h2>Efficient CSS</h2><p class="read-block">CSS rules are evaluated <b>right to left</b></p><p style="margin-top: 60px;">First a.home, then upwards</p><pre><code>ul > li a.home {
  ...
}
</code></pre></section><section><h2>Selector performance</h2><p>Best to worst</p><ul class="read-block"><li>#id</li><li>.class</li><li>div</li><li>*</li></ul></section><section><h2>Improve performance</h2><div class="row-fluid"><div class="span6"><p>BAD:</p><pre><code>/* avoid generic selectors */
* {
  font-size: 12px;
}
/* do not tag-qualify an id */  
div#main {
  width: 960px;
}
/* avoid descendants */
table.bill tbody tr td.cell {
  border: 1px solid #ccc;
}
/* avoid tag selectors */
.contact-data div {
  background: #fcc;
}</code></pre></div><div class="span6"><p>GOOD:</p><pre><code>&nbsp;
body {
  font-size: 12px;
}

#main {
  width: 960px;
}

.cell {
  border: 1px solid #ccc;
}

.div-contact-data {
  background: #fcc;
}
</code></pre></div></div></section><section><h2>Improve more</h2><div class="row-fluid"><div class="span4"><p>BAD:</p><pre><code>ul.links li a {
  color: #ccc;
}</code></pre></div><div class="span4"><p>BETTER:</p><pre><code>.links > li > a {
  color: #ccc;
}</code></pre></div><div class="span4"><p>BEST:</p><pre><code>.a-link {
  color: #ccc;
}
</code></pre></div></div></section><section><h2>Avoid sibling selectors</h2><pre><code>h1 + p {
  border: 1px solid #fff;
}</code></pre><p class="small-text read-block">WebKit typically achieves a 75% memory reduction in style footprint on pages that <b>don’t make use of sibling selectors</b> – Dave Hyatt, (webkit architect) May 2008</p></section><section><h2>Avoid :hover on non-link</h2><p class="read-block">:hover on non-link elements (div, p, etc) <b>will fail or cause degraded performance</b> on IE</p></section><section><h2>Not to be taken too seriously</h2><p>Performance gains are typically below <b>50ms</b>, but many of these rules (like descendant selectors) also apply to reflows</p><a href="http://www.stevesouders.com/blog/2009/03/10/performance-impact-of-css-selectors/" class="source">Source: Steve Souders</a></section><section><h2>Avoid reflows</h2><p>A reflow is triggered in this video at minute 0:15</p><iframe width="420" height="315" src="http://www.youtube.com/embed/ZTnIxIA5KGw" frameborder="0" allowfullscreen></iframe></section><section><h2>Reflow triggered by images</h2><p class="read-block">Specify <b>width</b> and <b>height</b> on all your images</p></section><section><h2>Reflows triggered by animations</h2><p>Get your animations out of the rendering tree by using <b>position=absolute or fixed</b></p></section><section><h2>Reflows triggered by :hover</h2><p>Avoid changing the size of your elements using :hover (font-size, border-width, etc)</p><div id="ex-reflow-hover"><p class="hover-p"><b>Hover!</b></p><style>#ex-reflow-hover > .hover-p {
  -webkit-transition: all 0.5s linear;
  margin-bottom: 0;
}
#ex-reflow-hover > .hover-p:hover {
  font-size: 200%;
}
</style></div></section><section><h2>Reflows triggered by JavaScript</h2><p>Avoid Javascript manipulations of the DOM in a loop</p><div class="row-fluid"><div class="span6"><p><b>BAD</b></p><pre><code>var $ul = $('#myList');
myCollection.each(function(e) {
  $ul.append('&lt;li>' + e.name);
})</code></pre></div><div class="span6"><p><b>GOOD</b></p><pre><code>var items = '';
myCollection.each(function(e) {
  items += '&lt;li>' + e.name;
})
$('#myList').append(items);</code></pre></div></div><a href="http://www.stevesouders.com/blog/2009/03/10/performance-impact-of-css-selectors/" class="source">Source: Steve Souders</a></section><section><h2>Specificity has collisions</h2><p>Use classes to override styles</p><div id="priority-collisions"><style>#priority-collisions {
  -webkit-transform: scale(0.7, 0.7);
}
#priority-collisions p {
  margin-top: 70px;
}</style><div class="row-fluid"><div class="span5"><p>h3</p></div><div class="span7"><div class="priorities"><div class="labels"><small>inline</small><small>IDs</small><small>classes</small><small>elements</small></div><div class="levels"><div class="priority-level">0</div><div class="priority-level">0</div><div class="priority-level">0</div><div class="priority-level">1</div></div></div></div></div><div class="row-fluid"><div class="span5"><p>#sidebar h3 { ... }</p></div><div class="span7"><div class="priorities"><div class="labels"><small>inline</small><small>IDs</small><small>classes</small><small>elements</small></div><div class="levels"><div class="priority-level">0</div><div class="priority-level">1</div><div class="priority-level">0</div><div class="priority-level">1</div></div></div></div></div><div class="row-fluid"><div class="span5"><p style="font-size: 90%;">#sidebar .account h3 { ... }</p></div><div class="span7"><div class="priorities"><div class="labels"><small>inline</small><small>IDs</small><small>classes</small><small>elements</small></div><div class="levels"><div class="priority-level">0</div><div class="priority-level">1</div><div class="priority-level">1</div><div class="priority-level">1</div></div></div></div></div></div><a href="http://www.slideshare.net/stubbornella/our-best-practices-are-killing-us" class="source">Source: Nicole Sullivan</a></section><section><h2>!important</h2><p>Duplicates the problem</p><div class="row-fluid"><div class="span5"><p style="margin-top: 70px">Normal styles</p></div><div class="span7"><div class="priorities"><div class="labels"><small>inline</small><small>IDs</small><small>classes</small><small>elements</small></div><div class="levels"><div class="priority-level">&nbsp;</div><div class="priority-level">&nbsp;</div><div class="priority-level">&nbsp;</div><div class="priority-level">&nbsp;</div></div></div></div></div><div class="row-fluid"><div class="span5"><p style="margin-top: 70px">Important styles</p></div><div class="span7"><div class="priorities"><div class="labels"><small>inline</small><small>IDs</small><small>classes</small><small>elements</small></div><div class="levels"><div class="priority-level">&nbsp;</div><div class="priority-level">&nbsp;</div><div class="priority-level">&nbsp;</div><div class="priority-level">&nbsp;</div></div></div></div></div></section><section><h2>CSS Lint</h2><p>CSS Lint analyzes your CSS and points out problems with your code.</p><ul><li>Parsing errors</li><li>Possible Errors</li><li>Compatibility</li><li>Performance</li><li>Maintainability & Duplication</li></ul></section><section data-state="lab"><h2>Lab: CSS Lint</h2><p>Use CSS Lint to optimize css code</p></section><section><h2>Browser cache</h2><p class="read-block"><b>304</b> (Not Modified) responses</p><p class="read-block"><b>Expires</b> headers</p><p class="read-block"><b>Strong</b> and <b>weak</b> cache indicators</p></section><section><h2>304</h2><p class="read-block">Means "the browser already has the latest version of this file"</p><p class="read-block">Will happen with every click <b>unless Expires is used</b></p></section><section><h2>304 with Last-Modified</h2><p>If the server includes <b>Last-Modified</b> the browser will include <b>If-Modified-Since</b> with each subsequent request</p><p>Example: static files with apache / tomcat</p><img src="assets/raster/304-last-modified.png"></section><section><h2>304 with ETag</h2><p>If server includes <b>ETag</b> the browser will include <b>If-None-Match</b> with each further request</p><p>Example: &lt;inode>-&lt;file-size>-&lt;last-modified> with apache</p><img src="assets/raster/304-etag.png"></section><section><h2>Expires header</h2><p>Indicates for <b>how long the file should not be retrieved again</b>.</p><img src="assets/raster/expires.png"></section><section><h2>Expires header</h2><ul><li>Cache-control (max-age)<ul><li>HTTP 1.1</li><li>Seconds to expire</li><li>Used by the browser</li></ul></li><li>Expires:<ul><li>HTTP 1.0</li><li>Date</li><li>Used by proxies installed during the Roman Empire</li></ul></li></ul></section><section><h2>The Refresh button</h2><ul><li><b>Refresh (or F5)</b>: a new request will be sent for each file.<ul><li>Any <b>If-Modified-Since</b> or <b>If-None-Match</b> headers will be sent.</li><li>The server may return a 304 response.</li></ul></li><li><b>Shift + Refresh (or Ctrl + F5)</b>: a new request will be sent for each file.<ul><li>Any <b>If-Modified-Since</b> or <b>If-None-Match</b> headers will not be sent.</li><li>The server cannot return a 304 response.</li></ul></li></ul></section><section><h2>And that's all</h2><ul><li><b>304 and Expires</b>. That's all you have.</li><li>Now, <b>which data indicator</b> do you plan to use for caching?<ul><li>Last modified, MD5 checksum...</li></ul></li></ul></section><section><h2>Weak and strong indicators</h2><ul><li><b>Weak</b>: The indicator may change even if the file did not.<ul><li>Last-Modified, default ETag implementations.</li></ul></li><li><b>Strong</b>: The indicator changes only with the resource contents.<ul><li>MD5, version numbers.</li></ul></li><li>Strong indicators can be inserted in the URL or used as ETag.</li></ul></section><section><h2>Strong indicators</h2><ul><li><b>Version numbers</b><ul><li>http://ajax.googleapis.com/ajax/libs/jquery/1.4.1/jquery.min.js</li></ul></li><li><b>Revision numbers</b><ul><li>http://localhost/myentity?id=5&revision=20</li></ul></li><li><b>MD5</b><ul><li>http://localhost/images/photo.gif?checksum=9e0bee8ace86b2230140642adcf57c4c</li></ul></li></ul></section><section><h2>Expires & strong indicators</h2><p>Using strong indicators, you can set your Expires header to cache forever (1-10 years)</p><p><b>Use only with immutable resources</b></p></section><section data-state="lab"><h2>Lab: Browser Cache</h2><p>Test the browser cache</p></section><section><h2>Keep sharp</h2><p><a href="https://developers.google.com/speed/docs/best-practices/rules_intro">Google performance best practices</a></p></section></div><aside class="controls"><a href="#" class="left">◄</a><a href="#" class="right">►</a><a href="#" class="up">▲</a><a href="#" class="down">▼</a></aside><div class="progress"><span></span></div></div><script src="assets/js/head.min.js"></script><script src="assets/js/reveal.custom.min.js"></script><script src="assets/js/html5shiv.js"></script><script>//- Full list of configuration options available here:
//- https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({
controls: true,
progress: true,
history: true,
rollingLinks: false,
transition: 'linear',
//- Optional libraries used to extend on reveal.js
dependencies: [
{ src: 'assets/js/highlight.js', async: true, callback: function() { window.hljs.initHighlightingOnLoad(); } },
{ src: 'assets/js/classList.js', condition: function() { return !document.body.classList; } },
//-{ src: 'assets/js/showdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
//-{ src: 'assets/js/data-markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
{ src: 'socket.io/socket.io.js', async: true, condition: function() { return window.location.host === 'localhost:1947'; } },
{ src: 'plugin/speakernotes/client.js', async: true, condition: function() { return window.location.host === 'localhost:1947'; } },
]
});</script><script>var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-2309405-10']);
_gaq.push(['_trackPageview']);
(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script></body></html>